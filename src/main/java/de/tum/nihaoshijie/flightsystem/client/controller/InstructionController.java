package de.tum.nihaoshijie.flightsystem.client.controller;import com.jfoenix.controls.JFXButton;import de.tum.nihaoshijie.flightsystem.server.persistence.Entertainment;import de.tum.nihaoshijie.flightsystem.server.persistence.Instruction;import javafx.event.ActionEvent;import javafx.fxml.FXML;import javafx.fxml.FXMLLoader;import javafx.scene.layout.AnchorPane;import javafx.scene.media.Media;import javafx.scene.media.MediaPlayer;import javafx.scene.media.MediaView;import org.springframework.core.ParameterizedTypeReference;import org.springframework.http.HttpHeaders;import org.springframework.http.MediaType;import org.springframework.web.reactive.function.client.WebClient;import java.io.File;import java.util.List;import java.util.Objects;public class InstructionController {    private static final String SERVICE_MAIN_PATH = "/clientview/fxmls/ServiceMain.fxml";    private WebClient webClient;    private MediaPlayer player;    @FXML    private JFXButton backButton;    @FXML    private AnchorPane mainPane;    @FXML    private MediaView mediaView;    @FXML    private JFXButton pauseButton;    @FXML    private JFXButton playButton;    @FXML    private JFXButton stopButton;    @FXML    void initialize() {        webClient = WebClient.builder().baseUrl("http://localhost:8080/")                .defaultHeader(HttpHeaders.CONTENT_TYPE, MediaType.APPLICATION_JSON_VALUE)                .build();        final List<Instruction> instructions = webClient.get().uri(urlBuilder -> urlBuilder                        .path("/instruction")                        .queryParam("type", "ALL")                        .build())                .retrieve()                .bodyToMono(new ParameterizedTypeReference<List<Instruction>>() {                })                .onErrorStop()                .block();        if (instructions == null || instructions.size() == 0) {            return;        }        File file = new File(Objects.requireNonNull(instructions.get(0).getUrl()));        Media m = new Media(file.toURI().toString());        player = new MediaPlayer(m);        mediaView.setMediaPlayer(player);    }    @FXML    void pause(ActionEvent event) {        player.pause();    }    @FXML    void play(ActionEvent event) {        player.play();    }    @FXML    void stop(ActionEvent event) {        player.stop();    }    @FXML    void back(ActionEvent event) {        try {            mainPane.getScene().setRoot(FXMLLoader.load(Objects.requireNonNull(getClass().getResource(SERVICE_MAIN_PATH))));        } catch (Exception ex) {            ex.printStackTrace();        }    }}